前言：考试形式半闭半开(各一个小时)，今年简答题变成选择题，朱老师说结合教学系统的 RAG 让 AI 出题复习，考题一部分从里面出。

ps：今年切忌只看apue笔记和课本，一是容易过度复习，二是考试范围是老师教学课件里面的ppt，有六章内容是笔记没有的。别问我怎么知道的(╥﹏╥) 

一、选择题(2 *20)

其中前十题涵盖前十章ppt的基础内容，后十题涵盖后六章ppt的内容(主要是eBPF,Rust,ROS),看课件和RAG出题可以解决大部分题目

二、改错题(2 *5) 考察Rust Vec，两题在ppt中
1. 找出下面代码的问题
（Vec的动态扩容）
```c
void vec_push(Vec* vec, int n) {
    if (vec->length == vec->capacity) {
        int new_capacity = vec->capacity * 2;
        int* new_data = (int*) malloc(new_capacity);
        assert(new_data != NULL);
        for (int i = 0; i < vec->length; ++i) {
            new_data[i] = vec->data[i];
        }
        vec->data = new_data;
        vec->capacity = new_capacity;
    }
    vec->data[vec->length] = n;
    ++vec->length;
}
```
2. 找出下面代码的问题
（Vec的初始化）
```c
Vec* vec_new() {
    Vec vec;
    vec.data = NULL;
    vec.length = 0;
    vec.capacity = 0;
    return &vec;
}
```
三、代码阅读题(1 *10) 和去年基本一样
```c
#include <sys/types.h>
#include "apue.h"
 int main(void) {
 	int var; 
 	pid_t pid;
 	var = 7; //数据改了
     
 	if (write(STDOUT_FILENO, "hello\n" , 6 ) != 6) //这里改了
 		err_sys("write error");
     
 	printf("before fork\n"); 
     
 	if ((pid = fork()) < 0)  
		err_sys("fork error");
 	else if (pid == 0) {    
		var++;
 	} else{
    	var--;
 	};   
 	printf("var = %d\n", var);
 	exit(0);
 }

```

(1)使用以下命令运行此程序，写出输出情况。

```shell
$ a.out
```
(2)使用以下命令运行此程序，写出输出情况。

```shell
$ a.out > temp.out 
$ cat temp.out
```

四、编程题(2 *20)
1. 实现教材p440 上的popen的功能(开放题，可以实现大小写字符变换或者自定义)
2. 实现sync，要求(1) 输入一个起始目录和一个目标目录 (2)用open(),read(),write() (3) 实现递归？(不确定)

